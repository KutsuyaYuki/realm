---
title: "Page Transition in Astro using Turbo and Turn"
date: "2023-04-08"
description: "Neat SSR page transitions. Not even kidding."
tags:
  - "javascript"
  - "astro"
---

## Introduction

So, yesterday I wrote about [how to turbocharge your Astro site with Turbo](/posts/turbocharge-astro). It is a really
good way to get that sweet SPA-like experience without the need for a full-blown SPA. But, it is missing one thing: page transitions.

So, in this post, we will be adding page transitions to our Astro site using [Turbo](https://turbo.hotwired.dev/) and [Turn](https://github.com/domchristie/turn)
by [domchristie](https://github.com/domchristie).

## What is Turn?

Turn is a library that allows you to add page transitions to your Turbo Drive powered site. It is a really simple library that
works by the old school way of adding a class to the root element and then using CSS to animate the transition, sprinkled with
some JavaScript to listen to some events and add/remove classes during the navigation lifecycle.

## Setting up Turn

Before going any further, make sure you have followed the instructions in the [previous post](/posts/turbocharge-astro) to set up
Turbo in your Astro site and (optional) have a basic understanding of how it works (optional cause I also can't bother to understand).

First, we need to install Turn:

```bash
pnpm add @domchristie/turn
```

Then, all we really need to do is to call the `Turn.start()` function in the `router.js` file (see the previous post for context):

```js
import Turn from "@domchristie/turn";
import * as Turbo from "@hotwired/turbo";

Turbo.start();
Turn.start();
```

That's it! Now, we can start adding some transitions.

## Choosing what to animate

Animating the entire HTML document is not really a good idea and animating something that really isn't changing (much) is not a
good idea either. So, we need to choose what to animate. In this case, we will be animating the `main` element. This is the
element that contains the content of the page, at least in this site. To let Turn know that we want to animate the `main`
element, we need to add a `data-turn-enter` and `data-turn-exit` attribute to it:

```astro
<!-- some code -->
<main
  class="some-class"
  data-turn-enter
  data-turn-exit
>
  <slot />
</main>
<!-- some more code -->
```

## Adding the transitions

Now that we have chosen what to animate, we need to add the transitions. This is done by adding some relevant CSS code to actually
animate the element. In this case, I'll just copy the CSS from my website (which is also using Turn):

```css
@keyframes fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes fade-out {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

@keyframes slide-up-out {
  from {
    transform: translateY(0);
  }
  to {
    transform: translateY(-20%);
  }
}

@keyframes slide-down-in {
  0% {
    transform: translateY(-20%);
  }
  100% {
    transform: translateY(0);
  }
}

html.turn-advance.turn-exit [data-turn-exit] {
  animation-name: fade-out, slide-up-out;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
}

html.turn-advance.turn-enter [data-turn-enter] {
  animation-name: fade-in, slide-down-in;
  animation-duration: 0.6s;
  animation-fill-mode: forwards;
}

html.turn-before-exit [data-turn-exit],
html.turn-exit [data-turn-exit] {
  will-change: transform, opacity;
}
```

Sure, you can get creative and add your own transitions, but I'm not going to go into that in this post.
Oh, and if you're too lazy to implement your own CSS, you can just import it from Turn. Just import the CSS file from the
Turn package and add it to your root layout (or wherever you want to add it since you might scope Turbo out or something):

```astro
---
import "@domchristie/turn/dist/turn.css";
---
```

Uh huh, that's it honestly. Now, you have page transitions in your Astro site. Pretty neat, huh?

## Conclusion

That's it for this post. I hope you enjoyed it and learned something new. If you have any questions, feel free to ask them
in the comments. See you next time!
